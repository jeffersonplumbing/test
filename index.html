<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sonar Web App</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { margin-left: 10px; }
    </style>
</head>
<body>
    <h1>Sonar Web App Fixed?</h1>
    <p>Ready</p>
    <h2>Results:</h2>
    <p>Measurement 1: <span id="measurement-1">--</span> <button onclick="runTest(1)">Run Test</button></p>
    <p>Measurement 2: <span id="measurement-2">--</span> <button onclick="runTest(2)">Run Test</button></p>
    <p>Measurement 3: <span id="measurement-3">--</span> <button onclick="runTest(3)">Run Test</button></p>
    <p>Measurement 4: <span id="measurement-4">--</span> <button onclick="runTest(4)">Run Test</button></p>
    <p>Measurement 5: <span id="measurement-5">--</span> <button onclick="runTest(5)">Run Test</button></p>

    <script>
        const ctx = new (window.AudioContext || window.webkitAudioContext)();

        function playPulse(frequency, duration = 0.1) {
            const oscillator = ctx.createOscillator();
            oscillator.type = 'sine'; // Sine wave for clean pulse sound
            oscillator.frequency.setValueAtTime(frequency, ctx.currentTime);
            oscillator.connect(ctx.destination);
            oscillator.start();
            oscillator.stop(ctx.currentTime + duration);
        }

        function runTest(testNumber) {
            const frequencies = [100, 500, 2000, 8000]; // Very low to high frequencies in Hz
            const results = []; // To store simulated results (e.g., echo times)

            frequencies.forEach((freq, index) => {
                setTimeout(() => {
                    playPulse(freq);
                    // Simulate a measurement result (e.g., random echo time in ms)
                    const simulatedResult = Math.floor(Math.random() * 100) + 50;
                    results.push(`${freq} Hz: ${simulatedResult} ms`);
                    // If last pulse, update the UI
                    if (index === frequencies.length - 1) {
                        updateResults(testNumber, results.join(' | '));
                    }
                }, index * 300); // 300ms delay between pulses for clarity
            });
        }

        function updateResults(testNumber, resultText) {
            document.getElementById(`measurement-${testNumber}`).innerText = resultText;
        }
    </script>
</body>
</html>
